# Notes about regex in SQL:
# (1) Use 'SIMILAR TO'.
#     https://stackoverflow.com/questions/51860219/how-to-use-apache-calcite-like-regex
# (2) '_' is special character in SQL regex, it should be escaped. The default escape character is
#     '\u0000'. However this is not allowed in multi-line string. So explicitly specify one here.
#     https://stackoverflow.com/questions/35746109/how-to-do-unicode-escaping-in-yaml-multiline-string
# (3) '$' is special character in java regex, but regular in SQL regex. so '$' is not used here.
RULE_1_STR: |
    SELECT 1 as bot_1
    FROM soj.idl_event
    WHERE agentInfo SIMILAR TO '.*bot[^a-z0-9\_-].*|.*bot|.*spider.*|.*crawl.*|.*ktxn.*' ESCAPE '\'

ICF_RULE_1_STR: |
    SELECT 801 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 1)

ICF_RULE_2_STR: |
    SELECT 802 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 2)

ICF_RULE_3_STR: |
    SELECT 803 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 3)

ICF_RULE_4_STR: |
    SELECT 804 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 4)

ICF_RULE_5_STR: |
    SELECT 805 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 5)

ICF_RULE_6_STR: |
    SELECT 806 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 6)

ICF_RULE_7_STR: |
    SELECT 807 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 7)

ICF_RULE_10_STR: |
    SELECT 808 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 10)

ICF_RULE_11_STR: |
    SELECT 809 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 11)

ICF_RULE_12_STR: |
    SELECT 810 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 12)

ICF_RULE_13_STR: |
    SELECT 811 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 13)

ICF_RULE_56_STR: |
    SELECT 812 as bot_flag
    FROM soj.idl_event
    WHERE checkBit(icfBinary, 56)
